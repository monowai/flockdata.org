<!--
  ~
  ~  Copyright (c) 2012-2016 "FlockData LLC"
  ~
  ~  This file is part of FlockData.
  ~
  ~  FlockData is free software: you can redistribute it and/or modify
  ~  it under the terms of the GNU General Public License as published by
  ~  the Free Software Foundation, either version 3 of the License, or
  ~  (at your option) any later version.
  ~
  ~  FlockData is distributed in the hope that it will be useful,
  ~  but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~  GNU General Public License for more details.
  ~
  ~  You should have received a copy of the GNU General Public License
  ~  along with FlockData.  If not, see <http://www.gnu.org/licenses/>.
  -->

<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Explore
    <small>your Fortress as a graph</small>
  </h1>
  <ol class="breadcrumb">
    <li><a ui-sref="welcome"><i class="fa fa-home"></i> Home</a></li>
    <li class="active">Explore</li>
  </ol>
</section>

<!-- Main content -->
<section class="content">
  <div class="row">
    <div class="col-sm-8 col-md-3 col-lg-3">
      <!-- Default box -->
      <div class="box box-primary">
        <div class="box-header with-border">
          <h3 class="box-title">Search</h3>

          <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
              <i class="fa fa-minus"></i></button>
            <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
              <i class="fa fa-times"></i></button>
          </div>
        </div>

        <form role="form">
          <div class="box-body">
            <fieldset >
              <section class="form-group">
                <label>Graph Layout</label>
                <select ng-model="layout" ng-options="l.name for l in layouts" class="form-control">
                </select>
              </section>
              <section class="form-group">
                <label>Fortress</label>
                <select class="form-control" ng-model="fortress" multiple
                        ng-options="f.name as f.name for f in fortresses"
                        ng-change="selectFortress()"></select>
              </section>
              <section class="form-group" ng-show="documents.length>0">
                <label>Documents</label>
                <select class="form-control" ng-model="document" multiple
                        ng-options="d.name as d.name for d in documents"
                        ng-change="selectDocument()"></select>
              </section>
              <section class="form-group" ng-show="concepts.length>0">
                <label>Tags</label>
                <select class="form-control" ng-model="concept" multiple
                        ng-options="c.name as c.name for c in concepts"
                        ng-change="selectConcept()"></select>
              </section>
              <section class="form-group" ng-show="!relationshipChecked && fromRlxs.length>0">
                <label>Relationship From</label>
                <select class="form-control" ng-model="fromRlx" multiple
                        ng-options="rf.name as rf.name for rf in fromRlxs"></select>
              </section>
              <section class="form-group" ng-hide="shareRelationships || sharedRlxChecked">
                <label>Relationship To</label>
                <select class="form-control" ng-model="toRlx" multiple
                        ng-options="rt.name as rt.name for rt in toRlxs"></select>
              </section>

              <section class="form-group">
                <div class="checkbox">
                  <label ng-class="{'state-enabled':sumByCount}">
                    <input type="checkbox" ng-enabled="sumByCount"
                           ng-model="sumByCountChecked">
                    <i></i>Sum by count</label>
                </div>
              </section>

              <section class="form-group" ng-if="devMode">
                <div class="checkbox" ng-class="{'state-enabled':shareRelationships}">
                  <label>
                    <input type="checkbox" ng-enabled="shareRelationships"
                           ng-model="sharedRlxChecked">
                    <i></i>Share Relationships</label>
                </div>
              </section>

              <section class="form-group" ng-if="devMode">
                <div class="checkbox" ng-class="{'state-disabled':reciprocalExcluded}">
                  <label>
                    <input type="checkbox" ng-enabled="reciprocalExcluded"
                           ng-model="reciprocalExcludedChecked">
                    <i></i>Exclude Reciprocals</label>
                </div>
              </section>

              <section>
                <div class="form-group col-md-6">
                  <label for="minCount">Min Occurence</label>
                  <input type="text" class="form-control" name="minCount" id="minCount" ng-model="minCount"/>
                </div>
                <div class="form-group col-md-6">
                  <label for="resultSize">Sample Size</label>
                  <input type="text" class="form-control" name="resultSize"
                         id="resultSize" ng-model="resultSize"/>
                </div>
              </section>

            </fieldset>
          </div>
        </form>

        <!-- /.box-body -->
      </div>
      <!-- /.box -->
    </div>
    <!-- Chart box -->
    <div class="col-xs-10 col-sm-10 col-md-9 col-lg-9">
      <div class="box">
        <div class="box-header with-border">
          <i class="fa fa-area-chart"></i>
          <h3 class="box-title">View</h3>

          <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
              <i class="fa fa-minus"></i></button>
            <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
              <i class="fa fa-times"></i></button>
          </div>
        </div>
        <div class="box-body">
          <div class="input-group">
            <div class="input-group-btn">
              <button type="submit" class="btn btn-primary" ng-click="search()">
                <i class="fa fa-search"></i> View
              </button>
            </div>
            <input type="search" class="form-control" value="*" placeholder="Select criteria before applying a filter ..." ng-model="$root.searchText"
                   size="100" autocomplete="on"/>
          </div>
          <div class="alert alert-warning fade in" ng-show="msg">
            {{msg}}
          </div>
          <div ng-height="150">
            <!--<div id="cy"></div>-->

            <cytoscape elements="graphData" layout="layout" styles="styles"></cytoscape>
            <div class="controls">
              <div class="col-xs-6 col-md-4">
                <button class="btn btn-info" ng-click="changeLayout()">Change layout</button>
              </div>
            </div>
          </div>

        </div>
        <!-- /.box-body -->
        <div class="box-footer">
          <div id="tooltip"></div>
        </div>
        <!-- /.box-footer-->
      </div>
      <!-- /.box -->
    </div>
  </div>
</section>
